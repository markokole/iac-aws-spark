---
- hosts: all
  #gather_facts: no
  become: true
  roles:
    - prereq
    - spark

- hosts: spark_master
  #gather_facts: no
  become: true
  roles:
    - start_spark_master

- hosts: spark_worker
  #gather_facts: no
  become: true
  roles:
    - start_spark_workers

- hosts: spark_master
  #gather_facts: no
  become: true
  roles:
    - execute_on_spark